-- SQL Server Database script

USE master
GO
-- Drop database if existing
DROP DATABASE FS3SimulationDatabase
GO
-- Create database
CREATE DATABASE FS3SimulationDatabase
GO

USE FS3SimulationDatabase
GO

-- Create user table
CREATE TABLE [Users] (
    UserID int IDENTITY(1,1) PRIMARY KEY,
    Username NVARCHAR(20) NOT NULL,
    [Password] NVARCHAR(100) NOT NULL, -- Check size of hashed password
    UserType int NOT NULL,
    FirstName NVARCHAR(50),
    LastName NVARCHAR(50),
    SchoolID int -- FK to school table
)
GO

-- Create category reference tables
CREATE TABLE GeneralInfo (
    InfoID int PRIMARY KEY,
    InfoName NVARCHAR(50) NOT NULL,
)
GO

CREATE TABLE HealthCondition (
    ConditionID int PRIMARY KEY,
    ConditionCatID int NOT NULL,
    ConditionName NVARCHAR(50) NOT NULL
)
GO

CREATE TABLE FunctionalAbility (
    AbilityID int PRIMARY KEY,
    AbilityCatID int NOT NULL,
    AbilityName NVARCHAR(50) NOT NULL
)
GO

-- Create citizen table
CREATE TABLE Citizen (
    CitizenID int IDENTITY(1,1) PRIMARY KEY,
    FirstName NVARCHAR(50) NOT NULL,
    LastName NVARCHAR(50) NOT NULL,
)

-- Create Citizen to category table
CREATE TABLE CitizenInfo (
    CitizenID int FOREIGN KEY REFERENCES Citizen(CitizenID),
    InfoID int FOREIGN KEY REFERENCES GeneralInfo(InfoID),
    InfoText NVARCHAR(MAX),
    CONSTRAINT PK_CitizenInfo PRIMARY KEY (CitizenID, InfoID)
)
GO

CREATE TABLE CitizenCondition (
    CitizenID int FOREIGN KEY REFERENCES Citizen(CitizenID),
    ConditionID int FOREIGN KEY REFERENCES HealthCondition(ConditionID),
    ConditionStatus int NOT NULL,
    ConditionNote NVARCHAR(MAX),
    ConditionAssessment NVARCHAR(MAX),
    ConditionExpectation NVARCHAR(20),
    ConditionObservation NVARCHAR(MAX),
    CONSTRAINT PK_CitizenCondition PRIMARY KEY (CitizenID, ConditionID)
)
GO

CREATE TABLE CitizenAbility (
    CitizenID int FOREIGN KEY REFERENCES Citizen(CitizenID),
    AbilityID int FOREIGN KEY REFERENCES FunctionalAbility(AbilityID),
    AbilityStatus int NOT NULL,
    CurrentLevel int,
    ExpectedLevel int,
    AbilityNote NVARCHAR(MAX),
    CitizenExecution NVARCHAR(50),
    CitizenLimitation NVARCHAR(50),
    CitizenGoal NVARCHAR(MAX),
    AbilityObservation NVARCHAR(MAX),
    CONSTRAINT PK_CitizenAbility PRIMARY KEY (CitizenID, AbilityID)
)
GO

-- Create Student to citizen table
CREATE TABLE StudentCitizen(
    UserID int FOREIGN KEY REFERENCES Users(UserID),
    CitizenID int FOREIGN KEY REFERENCES Citizen(CitizenID),
    CONSTRAINT PK_StudentCitizen PRIMARY KEY (UserID, CitizenID)
)
GO


-- Test Users
INSERT INTO Users (Username, [Password], UserType, FirstName, LastName, SchoolID)
VALUES ('admin', 'pass', 1, 'firstname', 'lastname', null)
GO
INSERT INTO Users (Username, [Password], UserType, FirstName, LastName, SchoolID)
VALUES ('teacher', 'pass', 2, 'firstname', 'lastname', 1)
GO
INSERT INTO Users (Username, [Password], UserType, FirstName, LastName, SchoolID)
VALUES ('student', 'pass', 3, 'firstname', 'lastname', 1)
GO

-- Test Citizen
INSERT INTO Citizen (FirstName, LastName)
VALUES ('Peter', 'Hansen')
GO
INSERT INTO StudentCitizen (UserID, CitizenID)
VALUES (3, 1)
GO

-- Citizen care info tables
INSERT INTO GeneralInfo (InfoID, InfoName)
VALUES (1, 'Mestring'),
(2, 'Motivation'),
(3, 'Ressourcer'),
(4, 'Roller'),
(5, 'Vaner'),
(6, 'Uddannelse og job'),
(7, 'Livshistorie'),
(8, 'Netværk'),
(9, 'Helbredsoplysninger'),
(10, 'Hjælpemidler'),
(11, 'Boligens indretning')
GO

INSERT INTO HealthCondition (ConditionID, ConditionCatID, ConditionName)
VALUES
(1, 1, 'Problemer med personlig pleje'),
(2, 1, 'Problemer med daglige aktiviteter'),
(3, 2, 'Problemer med mobilitet og bevægelse'),
(4, 3, 'Problemer med væskeindtag'),
(5, 3, 'Problemer med fødeindtag'),
(6, 3, 'Uhensigtsmæssig vægtændring'),
(7, 3, 'Problemer med overvægt'),
(8, 3, '"Problemer med undervægt'),
(9, 4, 'Problemer med kirurgisk sår'),
(10, 4, 'Problemer med diabetisk sår'),
(11, 4, 'Problemer med cancersår'),
(12, 4, 'Problemer med tryksår'),
(13, 4, 'Problemer med arterielt sår'),
(14, 4, 'Problemer med venøst sår'),
(15, 4, 'Problemer med blandingssår'),
(16, 4, 'Problemer med traumesår'),
(17, 4, 'Andre problemer med hud og slimhinder'),
(18, 5, 'Problemer med kommunikation'),
(19, 6, 'Problemer med socialt samvær'),
(20, 6, 'Emotionelle problemer'),
(21, 6, 'Problemer med misbrug'),
(22, 6, 'Mentale problemer'),
(23, 7, 'Respirationsproblemer'),
(24, 7, 'Cirkulationsproblemer'),
(25, 8, 'Problemer med seksualitet'),
(26, 9, 'Akutte smerter'),
(27, 9, 'Periodevise smerter'),
(28, 9, 'Kroniske smerter'),
(29, 9, 'Problemer med synssans'),
(30, 9, 'Problemer med lugtesans'),
(31, 9, 'Problemer med hørelse'),
(32, 9, 'Problemer med smagssans'),
(33, 9, 'Problemer med følesans'),
(34, 10, 'Døgnrytmeproblemer'),
(35, 10, 'Søvnproblemer'),
(36, 11, 'Problemer med hukommelse'),
(37, 11, 'Problemer med sygdomsindsigt'),
(38, 11, 'Problemer med indsigt i behandlingsformål'),
(39, 11, 'Kognitive problemer'),
(40, 12, 'Problemer med vandladning'),
(41, 12, 'Problemer med urininkontinens'),
(42, 12, 'Problemer med afføringsinkontinens'),
(43, 12, 'Problemer med mave og tarm')
GO

INSERT INTO FunctionalAbility (AbilityID, AbilityCatID, AbilityName)
VALUES
(1, 1, 'Vaske sig'),
(2, 1, 'Gå på toilet'),
(3, 1, ''),
GO